<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <meta
      http-equiv="Content-Security-Policy"
      content="
      default-src 'self';
      script-src 'self' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com;
      style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://fonts.googleapis.com;
      connect-src 'self' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://kxzxwwzhyyumlgkmlapb.supabase.co wss://kxzxwwzhyyumlgkmlapb.supabase.co;
      font-src 'self' https://cdnjs.cloudflare.com https://fonts.gstatic.com;
      img-src 'self' data:;
      object-src 'self' data:;
      base-uri 'self';
      form-action 'self';
    "
    />

    <title>Fluxo ESTRATÉGICO</title>
    <link
      rel="icon"
      href="data:image/svg+xml, <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23007bff' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'>
  <path d='M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8'/>
  <path d='M21 3v5h-5'/>
  <path d='M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16'/>
  <path d='M3 21v-5h5'/>
</svg>"
    />

    <link rel="stylesheet" href="src/css/style.css" />
    <link rel="stylesheet" href="src/css/global-tooltip.css" />
    <link rel="stylesheet" href="src/css/toast.css" />
    <link rel="stylesheet" href="src/css/timer.css" />
    <link rel="stylesheet" href="src/css/form.css" />
    <link rel="stylesheet" href="src/css/table.css" />
    <link rel="stylesheet" href="src/css/streak-dot.css" />
    <link rel="stylesheet" href="src/css/config-screen.css" />
    <link rel="stylesheet" href="src/css/achievements.css" />
    <link rel="stylesheet" href="src/css/calendar.css" />
    <link rel="stylesheet" href="src/css/filters-style.css" />
    <link rel="stylesheet" href="src/css/form-manual-entry.css" />
    <link rel="stylesheet" href="src/css/life-time-stats.css" />
    <link rel="stylesheet" href="src/css/categories-new.css" />
    <link rel="stylesheet" href="src/css/color-picker.css" />
    <link rel="stylesheet" href="src/css/notes.css" />
    <link rel="stylesheet" href="src/css/detailed-view.css" />
    <link rel="stylesheet" href="src/css/weekly-goals.css" />

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.1/dist/chart.umd.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
    />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.6/Sortable.min.js"
      integrity="sha512-csIng5zcB+XpulRUa+ev1zKo7zRNGpEaVfNB9On1no9KYTEY/rLGAEEpvgdw6nim1WdTuihZY1eqZ31K7/fZjw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <link
      href="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.snow.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/fflate@0.8.2/umd/index.js"></script>
    <link rel="stylesheet" href="src/css/backup.css" />
  </head>

  <body>
    <div class="app-container">
      <div id="screen-home"></div>

      <div id="screen-timer" class="hidden"></div>

      <div id="screen-finish" class="hidden screen-finish"></div>

      <div id="screen-config" class="hidden"></div>

      <div id="screen-reports" class="hidden"></div>

      <div id="screen-achievements" class="hidden"></div>
    </div>

    <div id="calendar-modal" class="modal-overlay hidden">
      <div class="modal-content calendar-box">
        <div class="calendar-header">
          <button id="cal-prev" class="cal-nav-btn">&#10094;</button>
          <h3 id="cal-month-year">Mês Ano</h3>
          <button id="cal-next" class="cal-nav-btn">&#10095;</button>
        </div>

        <div class="calendar-weekdays">
          <div>Dom</div>
          <div>Seg</div>
          <div>Ter</div>
          <div>Qua</div>
          <div>Qui</div>
          <div>Sex</div>
          <div>Sáb</div>
        </div>

        <div id="calendar-grid" class="calendar-grid"></div>

        <div style="text-align: center; margin-top: 20px">
          <button
            id="btn-close-calendar"
            class="btn btn-black"
            style="padding: 8px 30px"
          >
            Fechar
          </button>
        </div>
      </div>
    </div>

    <div class="toast-container" id="toast-container"></div>
    <div class="toast-confirm-container" id="toast-confirm-container"></div>

    <div id="modal-manual-entry" class="modal hidden">
      <div class="modal-content card-elevated manual-modal-container">
        <h3 id="manual-modal-title" class="manual-modal-title"></h3>

        <form id="form-manual-entry">
          <div class="manual-field-group">
            <label class="manual-label">Matéria</label>
            <select id="manual-subject" class="manual-input" required>
              <option value="">Selecione...</option>
            </select>
          </div>

          <div class="manual-field-group">
            <label class="manual-label">Data e Hora</label>
            <div class="date-chips-container">
              <button type="button" class="date-chip selected" id="chip-today">
                Hoje
              </button>
              <button type="button" class="date-chip" id="chip-yesterday">
                Ontem
              </button>
              <button type="button" class="date-chip" id="chip-other">
                Outro
              </button>
            </div>
            <div style="display: flex; gap: 10px; margin-top: 10px">
              <input
                type="date"
                id="manual-date"
                class="manual-input"
                style="display: none"
              />
              <input type="time" id="manual-entry-time" class="manual-input" />
            </div>
          </div>
          <div class="manual-field-group">
            <label for="manual-time" class="manual-label"
              >Tempo de Estudo</label
            >
            <div class="manual-input-row">
              <input
                type="text"
                id="manual-time"
                class="manual-input"
                placeholder="00:00:00"
                maxlength="8"
                required
              />
            </div>
          </div>

          <div class="manual-field-group">
            <label class="manual-label">Questões (Opcional)</label>
            <div class="manual-input-row">
              <input
                type="number"
                id="manual-questions"
                class="manual-input"
                placeholder="Total"
                min="0"
              />
              <input
                type="number"
                id="manual-correct"
                class="manual-input"
                placeholder="Acertos"
                min="0"
              />
            </div>
          </div>

          <div class="manual-field-group">
            <label for="manual-category" class="manual-label">Categoria</label>
            <select id="manual-category" class="manual-input" required>
              <option value="">Selecione uma categoria</option>
            </select>
          </div>

          <div class="manual-actions-row">
            <button
              id="btn-manual-entry-cancel"
              type="button"
              class="btn btn-outline manual-btn-flex"
            >
              Cancelar
            </button>
            <button
              id="btn-save-manual-entry"
              type="submit"
              class="btn manual-btn-flex"
            >
              Salvar
            </button>
          </div>
        </form>
      </div>
    </div>

    <div id="modal-notes" class="modal hidden">
      <div class="notes-modal-container">
        <div
          style="
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
          "
        >
          <h3 class="manual-modal-title" style="margin: 0 !important">
            Anotações
          </h3>

          <i
            class="fa-solid fa-circle-info"
            style="
              font-size: 1rem;
              color: var(--text-secondary);
              cursor: help;
              opacity: 0.7;
            "
            data-tooltip="As anotações podem ser acessadas na aba de relatórios"
            data-tooltip-position="right"
          >
          </i>
        </div>

        <div
          id="quill-editor-container"
          style="
            height: 200px;
            background: var(--input-bg);
            color: var(--text-color);
          "
        ></div>

        <div class="manual-actions-row" style="margin-top: 15px">
          <button id="btn-close-notes" class="btn manual-btn-flex">
            Salvar
          </button>
        </div>
      </div>
    </div>

    <div id="modal-backup" class="modal hidden">
      <div class="modal-content backup-modal-container"></div>
    </div>

    <div id="modal-weekly-goals" class="modal hidden">
      <div class="modal-content weekly-goals-modal-container">
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
          "
        >
          <h2 style="margin: 0">Metas de Estudo Semanal</h2>
          <button
            id="close-weekly-goals-modal"
            class="weekly-goals-modal-btn-close"
            style="
              background: transparent;
              border: none;
              font-size: 24px;
              cursor: pointer;
              color: var(--text-color);
              padding: 0;
              width: 32px;
              height: 32px;
              display: flex;
              align-items: center;
              justify-content: center;
            "
          >
            ✕
          </button>
        </div>

        <p
          style="
            text-align: center;
            color: var(--text-secondary);
            margin-bottom: 20px;
            font-size: 14px;
          "
        >
          Configure as métricas para suas metas de estudo semanais.
        </p>

        <form
          id="form-weekly-goals"
          style="display: flex; flex-direction: column; gap: 15px"
        >
          <div class="weekly-goals-field-group">
            <label for="weekly-duration" class="weekly-goals-label"
              >DURAÇÃO</label
            >
            <input
              type="text"
              id="weekly-duration"
              class="weekly-goals-input"
              placeholder="00:00"
              maxlength="5"
            />
          </div>

          <div class="weekly-goals-field-group">
            <label for="weekly-questions" class="weekly-goals-label"
              >QUESTÕES</label
            >
            <input
              type="number"
              id="weekly-questions"
              class="weekly-goals-input"
              placeholder="0"
              min="0"
            />
          </div>

          <div style="display: flex; gap: 10px; margin-top: 15px">
            <button
              id="btn-cancel-weekly-goals"
              type="button"
              class="btn btn-outline"
              style="flex: 1"
            >
              Cancelar
            </button>
            <button
              id="btn-save-weekly-goals"
              type="submit"
              class="btn"
              style="flex: 1"
            >
              Salvar
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Dexie.js para IndexedDB -->
    <script src="https://cdn.jsdelivr.net/npm/dexie@4.0.8/dist/dexie.min.js"></script>

    <script type="module" src="src/js/main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.js"></script>
  </body>
</html>
